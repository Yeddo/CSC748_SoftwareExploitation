from boofuzz import *
 
def main():
    port = 9999 #vulnserver
    host = '127.0.0.1'
    protocol = 'tcp'
     
    csv_log = open('fuzz_results_vulnserver_HTER.csv', 'w') 
    my_logger = [FuzzLoggerCsv(file_handle=csv_log)] 
     
    options = {"proc_name": "vulnserver.exe", "stop_commands": ['wmic process where (name="vulnserver") delete'], "start_commands": ['C:\\Users\\FLARE\\vulnserver.exe']}
    # procmon = ProcessMonitor(host,26002)
    # procmon.set_options(**options)
    # monitors = [procmon]

    session = Session (
        target=Target(
            connection=SocketConnection(host,port, proto='tcp'),
            # monitors=monitors
        ),
        #reuse_target_connection=True,
        #index_start=1835,
        #index_end=1900,
        sleep_time=1,
        fuzz_loggers=[FuzzLoggerText(),FuzzLoggerCsv(file_handle=csv_log)]
        )
 
    s_initialize("VulnServer")
    s_string("HTER", fuzzable=False)
    s_string("FUZZ")
    s_static("\r\n")
         
    session.connect(s_get("VulnServer"))
    session.fuzz()
 
if __name__ == "__main__":
    main()