from boofuzz import *
 
def main():
    port = 27014
    host = '127.0.0.1'
    protocol = 'tcp'
     
    csv_log = open('fuzz_results_SpiderCat_CAT.csv', 'w') 
    my_logger = [FuzzLoggerCsv(file_handle=csv_log)] 
     
    options = {"proc_name": "SpiderCat1.exe", "stop_commands": ['wmic process where (name="SpiderCat") delete'], "start_commands": ['C:\\Users\\FLARE\\Downloads\\SpiderCat1.exe']}
    # procmon = ProcessMonitor(host,26002)
    # procmon.set_options(**options)
    # monitors = [procmon]

    session = Session (
        target=Target(
            connection=SocketConnection(host,port, proto='tcp'),
            # monitors=monitors
        ),
        reuse_target_connection=True,
        #index_start=1835,
        #index_end=1900,
        sleep_time=1,
        fuzz_loggers=[FuzzLoggerText(),FuzzLoggerCsv(file_handle=csv_log)]
        )
 
    s_initialize("Copycat")
    s_string("CAT ^@^@", fuzzable=False) # Fuzz w/NULL
    s_string("FUZZ")
         
    session.connect(s_get("Copycat"))
    session.fuzz()
 
if __name__ == "__main__":
    main()